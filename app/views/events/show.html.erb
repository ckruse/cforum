<%
content_for :title, @event.name
content_for :h1, @event.name
content_for(:body_id, "events-show")
content_for(:body_classes, 'events show event-' + @event.name.parameterize)
%>

<article class="thread-message event">
  <header class="message">
    <h2><%= link_to @event.name, event_path(@event) %></h2>

    <div class="details">
      <time datetime="<%= @event.start_date.strftime("%FT%T%:z") %>"><%= link_to l(@event.start_date, format: date_format('date_format_date')), event_path(@event) %></time>
      <% if @event.end_date != @event.start_date %>
        - <time datetime="<%= @event.end_date.strftime("%FT%T%:z") %>"><%= link_to l(@event.end_date, format: date_format('date_format_date')), event_path(@event) %></time>
      <% end %>

      <%= t('events.in', location: @event.location) %>
    </div>
  </header>

  <div class="posting-content event">
    <%= @event.to_html(@app_controller) %>

    <% unless @event.maps_link.blank? %>
      <h3><%= t('events.map') %></h3>

      <iframe src="<%= @event.maps_link %>"></iframe>
    <% end %>
  </div>

  <section>
    <h3><%= t('events.attendee_list', count: @event.attendees.length) %></h3>

    <ol>
      <% if @event.attendees.blank? %>
      <li class="no-data"><%= t('events.no_attendees') %></li>
      <% end %>

      <% @event.attendees.each do |attendee| %>
      <li>
        <%= render 'attendee', attendee: attendee %>
      </li>
      <% end %>
    </ol>

    <% if not @event.is_attendee(current_user) and @event.is_open? %>
      <p><%= cf_link_to t('events.attend'), new_event_attendee_path(@event), class: 'cf-primary-btn' %></p>
    <% end %>
  </section>
</article>
